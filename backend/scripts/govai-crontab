# GovAI Cron Jobs
# Install with: crontab /opt/govai/backend/scripts/govai-crontab
# Or add to existing crontab: crontab -e

# Environment variables
SHELL=/bin/bash
PATH=/usr/local/bin:/usr/bin:/bin
GOVAI_DIR=/opt/govai/backend
VENV_PYTHON=/opt/govai/venv/bin/python
LOG_DIR=/var/log/govai

# Discover new opportunities from SAM.gov every 15 minutes
*/15 * * * * cd $GOVAI_DIR && $VENV_PYTHON scripts/discover_opportunities.py >> $LOG_DIR/discovery.log 2>&1

# Send daily digest emails at 8 AM UTC
0 8 * * * cd $GOVAI_DIR && $VENV_PYTHON scripts/send_daily_digest.py >> $LOG_DIR/email.log 2>&1

# Send deadline reminders at 9 AM UTC
0 9 * * * cd $GOVAI_DIR && $VENV_PYTHON scripts/send_deadline_reminders.py >> $LOG_DIR/email.log 2>&1

# Clean up old opportunities at 2 AM UTC daily
0 2 * * * cd $GOVAI_DIR && $VENV_PYTHON scripts/cleanup_opportunities.py >> $LOG_DIR/cleanup.log 2>&1

# Rotate logs weekly (keep 4 weeks)
0 0 * * 0 find $LOG_DIR -name "*.log" -mtime +28 -delete



# USA Spending – weekly
0 2 * * 0 cd /opt/govai/backend && python scripts/discover_usaspending.py >> logs/usaspending.log 2>&1

# Forecasts – weekly
0 3 * * 1 cd /opt/govai/backend && python scripts/discover_forecasts.py >> logs/forecasts.log 2>&1

# DC OCP – hourly
0 * * * * cd /opt/govai/backend && python scripts/discover_dc_ocp.py >> logs/dc_ocp.log 2>&1

# DC Independent – hourly (offset)
15 * * * * cd /opt/govai/backend && python scripts/discover_dc_independent.py >> logs/dc_independent.log 2>&1

# Document text extraction – every 5 minutes
*/5 * * * * cd $GOVAI_DIR && $VENV_PYTHON scripts/extract_documents.py >> $LOG_DIR/extraction.log 2>&1

# Certification expiration reminders – daily at 10 AM UTC
0 10 * * * cd $GOVAI_DIR && $VENV_PYTHON scripts/send_certification_reminders.py >> $LOG_DIR/email.log 2>&1

# OSDBU directory import – monthly on the 1st at 3 AM UTC
0 3 1 * * cd $GOVAI_DIR && $VENV_PYTHON scripts/import_osdbu_contacts.py >> $LOG_DIR/import.log 2>&1

